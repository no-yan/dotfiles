{{ if eq .chezmoi.os "darwin" -}}
#!/bin/bash

# ~/.config/pnpm/global.txt からパッケージリストを読み込む
packages=($(cat ~/.config/pnpm/global.txt))

# 各パッケージをグローバルにインストール
for pkg in "${packages[@]}"; do
    pnpm add -g $pkg
done
{{end -}}

{{ if eq .chezmoi.os "darwin" -}}
#!/bin/bash

# List global package in pnpm with format: name@version
pnpm list -g --json | jq -r '.[].dependencies | to_entries[] | "\(.key)@\(.value.version)"' > ~/.config/pnpm/global.txt
{{end -}}
